# Frontend Helm Values Contract
# Feature: 001-k8s-helm-deployment
# Date: 2026-02-03
#
# This file defines the configuration contract for the todo-frontend Helm chart.
# DO NOT include actual secrets here. Use --set or a separate untracked file.

# Number of pod replicas
replicaCount: 1

# Container image configuration
image:
  repository: todo-frontend
  tag: "latest"
  pullPolicy: IfNotPresent

# Kubernetes Service configuration
service:
  type: NodePort
  port: 3000
  # NodePort for external access (30000-32767)
  nodePort: 30000

# Resource limits and requests
resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 256Mi

# Environment variables
# WARNING: Sensitive values MUST be provided via --set or external secrets
env:
  # Required: JWT signing secret (must match backend)
  # Generate with: openssl rand -hex 32
  BETTER_AUTH_SECRET: ""

  # Required: Neon PostgreSQL connection string (for Better Auth)
  # Format: postgresql://user:password@host/database?sslmode=require
  DATABASE_URL: ""

# Build-time environment variables (baked into image)
# These are set during docker build, not at runtime
buildEnv:
  # Backend API URL (K8s service DNS name)
  NEXT_PUBLIC_API_URL: "http://todo-backend:8000"

# Health check configuration
healthCheck:
  # Liveness probe path
  livenessPath: /
  # Readiness probe path
  readinessPath: /
  # Initial delay before probes start (Next.js needs more time)
  initialDelaySeconds: 15
  # Probe interval
  periodSeconds: 10
  # Timeout for each probe
  timeoutSeconds: 5
  # Failure threshold before restart
  failureThreshold: 3

# Pod security context
securityContext:
  runAsNonRoot: true
  runAsUser: 1000  # node user

# Service account (optional)
serviceAccount:
  create: false
  name: ""

# Node selector (optional)
nodeSelector: {}

# Tolerations (optional)
tolerations: []

# Affinity (optional)
affinity: {}
